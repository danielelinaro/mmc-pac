# MMC-PAC
Impedance calculation of modular multilevel converters using periodic small signal analysis (PAC)

The folder contains all the simulation files and codes (running on MATLAB) nedded to generate every figure of the paper "Modular Multi-level Converters Impedance Computation Based on Periodic Small-Signal Analysis and Vector Fitting".

For what concerns the main folder, files have the following extensions:
- .pan : these are the files that include the simulations to be carried out with PAN simulator. Each .pan file includes a netlist describing most of the simulated system. Some components are included in form of subcircuits: these are described by the .mod and .va files (see below).
- .mod : auxiliary files that describe at netlist level some power system components and controls common to each .pan file.
- -va  : files that describe some of the MMC controls with the Verilog-A language.

The folder "Figures" contains all the Matlab codes and .mat files nedded to generate each figure of the paper. The Matlab codes are named after the figures they generate. Each .mat file can be generated by simulating a specific .pan file (see below). The file "format_ticks" allows plotting graphs in a nice manner. The file "fitting" performs Vector Fitting (VF).

For further information, please refer to the paper or contact the Authors.

# SIMULATIONS DESCRIPTION
If ran, each PAN file generates one or more .mat file, which can be used to generate the figures in the "Figures" folder. The following holds:

- The "DcInf.pan" file simulates the power system shown in Fig.1(e) of the paper. By running it, one can obtain the .mat files necessary to plot the black lines in Fig.3, the lines in the top panel of Fig.5, the lines in Fig. 9, and the black lines in Fig.11.
- The "DcInf_unbalanced.pan" file simulates the power system shown in Fig.1(e) of the paper. Contrary to the previous .pan file, here the AC system  AC1 is associated with an unbalanced set of three-phase voltages. By running this file, one can obtain the .mat files necessary to plot the lines in Fig.10 and the gray lines in Fig. 11.
- The "DcLine.pan" file simulates a modified version of the power system shown in Fig.1(e) of the paper. In this case, a DC line is placed between the infinite DC bus and the dc1 bus. By running it, one can obtain the .mat files necessary to plot the magenta lines in Fig.3 and the lines in the middle panel of Fig.5.
- The "Dcs1.pan" file simulates the power system shown in Fig.1(d) of the paper. By running it, one can obtain the .mat files necessary to plot the green lines in Fig.3, the lines in Fig.4, and the lines in the bottom panel of Fig.5.
- The "Dcs1_800M.pan" file simulates the power system shown in Fig.1(d) of the paper. The control has been slightly modified to reduce the stability of the HVDC in case fault current limiters are added to the DC side. In addition, the reference power of MMC1 is -800MW (i.e., power withdrawal from the DC side). By running it, one can obtain the .mat files necessary to plot the black and red lines in Fig. 6.
- The "Dcs1_FCL.pan" file simulates the power system shown in Fig.1(d) of the paper. The control has been slightly modified to reduce the stability of the HVDC in case fault current limiters are added to the DC side. In addition, reference power of MMC1 changes with 6s steps of -100MW, until the value of -800MW is reached. Inductors representative of fault-current limiters are added to the DC side of MMC1. By running it, one can obtain the .mat files necessary to plot the lines in Fig. 8. The value of inductance can be modified at netlist level (see variable L_DC). 
